<!DOCTYPE html>

<meta charset="utf-8">
<body>





<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Nobile" />
<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Paytone+One" />
<link rel="stylesheet" type="text/css" href="a.css">
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
<script src="lib/d3/d3.js"></script>
<script src="lib/d3/d3-transform.js"></script>
<script src="js/VS.js"></script>
<script src="js/VS.menu.js"></script>
<script src="js/VS.layout.js"></script>
<script src="js/imgurls.js"></script>


<div class="container-full">

      <div class="row">
       
        <div class="col-lg-12 text-center v-center">
          
          <!--<h1>Hello Landing</h1>
          <p class="lead">A sign-up page example for Bootstrap 3</p>
          
          <br>-->
          <div id="div_svg"></div>
          <div id="div_menu_svg"></div>

          <!--<form class="col-lg-12">
            <div class="input-group input-group-lg col-sm-offset-3 col-sm-6 col-xs-offset-1 col-xs-10">
              <input type="text" class="center-block form-control input-lg" title="Search versus." placeholder="search versus...">
              <span class="input-group-btn"><button class="btn btn-lg btn-primary" type="button">go</button></span>
            </div>
          </form>-->
        </div>
        
      </div> <!-- /row -->
  
      <div class="row">
       
        <div class="col-lg-12 text-center v-center" style="font-size:39pt;">
          <a href="#"><i class="icon-google-plus"></i></a> <a href="#"><i class="icon-facebook"></i></a>  <a href="#"><i class="icon-twitter"></i></a> <a href="#"><i class="icon-github"></i></a> <a href="#"><i class="icon-pinterest"></i></a>
        </div>
      
      </div>
  
    <br><br><br><br><br>

</div> <!-- /container full -->


<script>


window.onload = function() {
  var fill = d3.scale.category20();

  VS.SVGHeight = window.innerHeight * 0.6;
  VS.SVGWidth = Math.min(document.getElementById("div_svg").clientWidth, 1024);
  VS.SVGMenuHeight = 70;


  var vsLayout = VS.Layout;
  var vsMenu = VS.menu();

  var svgLayout = null;
  //var inputData = [];
  var vs_rectdata = [];
  var vs_rects = [];


    function stringGen(len) {
        var text = "c";
        var charset = "abcdefghijklmnopqrstuvwxyz0123456789";
        for( var i=0; i < len; i++ ) {
            text += charset.charAt(Math.floor(Math.random() * charset.length));
        }
        return text;
    }


  function showLayout(inputData) {
      console.log('showing total: ', inputData.length);

      for(var i = 0; i < inputData.length;) {
          var d = inputData[i];
          if(vsLayout.addData(d, 1) == false) break;
          inputData.splice(i,1);
      }
      console.log('after place: ', inputData.length, 'placed: ', vsLayout.getData().length);
      vsLayout.compact();
      vsLayout.update(vsLayout.getData());
  }

  function startAll() {
      vsMenu.setMaxMode();
      vsMenu.setupMenuRendering(onMenuItemChanged);

      svgLayout = d3.select('#div_svg').append('svg')
                      .style('background','white');

      vsLayout.resize([VS.SVGWidth, VS.SVGHeight]);
      vsLayout.setup(svgLayout);

      var iid = Math.floor(Math.random()*240);
      inputData = [
            "Hello", "world", "normally", "you", "want", "more", "words",
            "Hello", "world", "normally", "you", "want", "more", "words",
            "than", "this", "Hello", "world", "normally", "you", "want", "more", "words",
            "Hello", "world", "normally", "you", "want", "more", "words"].map(function(d) {
            return {text: d, 
                    dim: 70 + Math.random() * 120, 
                    img_left: imgurls[iid++],
                    img_right: imgurls[iid++],
                    rat_left: Math.floor(Math.random()*200),
                    rat_right: Math.floor(Math.random()*200),
                    classname: stringGen(8)};
          }).sort(function(a, b) { return b.dim - a.dim; });
      showLayout(inputData);
  }

  function onMenuItemChanged(oldId, newId) {
      /*var xOffset = 0;
      if(newId == 0) {
          xOffset = VS.SVGWidth/2;
      } else {
          xOffset = -VS.SVGWidth;
      }*/
      var jump = newId - oldId;
      var xOffset = newId == 0 ? VS.SVGWidth/2 : -jump * VS.SVGWidth;
      
      vsLayout.setCurrentGroupId(newId);
      var newG = vsLayout.mainGroups()[newId];
      var oldG = vsLayout.mainGroups()[oldId];
      var inputData = null;
      if(vsLayout.getData().length == 0) {
        var iid = Math.floor(Math.random()*240);
        inputData = [
              "than", "this", "Hello", "world", "normally", "you", "want", "more", "words",
              "Hello", "world", "normally", "you", "want", "more", "words"].map(function(d) {
              return {text: d, 
                      dim: 40 + Math.random() * 70, 
                      img_left: imgurls[iid++],
                      img_right: imgurls[iid++],
                      rat_left: Math.floor(Math.random()*200),
                      rat_right: Math.floor(Math.random()*200),
                      classname: stringGen(8)};
            }).sort(function(a, b) { return b.dim - a.dim; });
      } else {
          inputData = vsLayout.getData();
      }
      showLayout(inputData)

      if(newG) newG.style('display', 'inline');
          vsLayout.mainGroups()[0].transition()
              .duration(550)
              .attr('transform', 'translate('+xOffset+','+VS.SVGHeight/2+')')
              .each('end', function() { 
                      //mnuMouseInEnabled = true; // FIXME: enable this flag in VS.menu
                      if(oldG) oldG.style('display', 'none');                        
                  });

      console.log('changing layout from ', oldId, '  to ', newId);
  }

  //Imgur.fetch(300, startAll);
  startAll();
}

</script>
</body>
